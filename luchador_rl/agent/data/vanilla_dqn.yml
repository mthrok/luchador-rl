layer_configs: &layer_configs
  - typename: TrueDiv
    args:
      denom: 255
      scope: layer0/preprocessing
  - typename: Conv2D
    args:
      n_filters: 32
      filter_width: 8
      filter_height: 8
      strides: 4
      padding: valid
      scope: layer1/conv2D
  - typename: ReLU
    args:
      scope: layer1/ReLU
  - typename: Conv2D
    args:
      n_filters: 64
      filter_width: 4
      filter_height: 4
      strides: 2
      padding: valid
      scope: layer2/conv2D
  - typename: ReLU
    args:
      scope: layer2/ReLU
  - typename: Conv2D
    args:
      filter_width: 3
      filter_height: 3
      n_filters: 64
      strides: 1
      padding: valid
      scope: layer3/conv2D
  - typename: ReLU
    args:
      scope: layer3/ReLU
  - typename: Flatten
    args:
      scope: layer4/flatten
  - typename: Dense
    args:
      n_nodes: 512
      scope: layer5/dense
  - typename: ReLU
    args:
      scope: layer5/ReLU
  - typename: Dense
    args:
      n_nodes: {n_actions}
      scope: layer6/dense

pre_trans: &pre_trans
  typename: Sequential
  scope: pre_trans
  args:
    name: pre_trans_q_network
    input_config:
      typename: Input
      args:
        dtype: uint8
        shape: {input_shape}
        name: pre_state
    layer_configs: *layer_configs

post_trans: &post_trans
  typename: Sequential
  scope: post_trans
  args:
    name: post_trans_q_network
    input_config:
      typename: Input
      args:
        dtype: uint8
        shape: {input_shape}
        name: post_state
    layer_configs: *layer_configs

typename: Container
args:
  model_configs:
    - <<: *pre_trans
      name: pre_trans
    - <<: *post_trans
      name: post_trans
